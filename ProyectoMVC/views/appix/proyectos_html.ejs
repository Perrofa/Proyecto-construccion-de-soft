<!DOCTYPE html>
<html lang="en">
  <%- include('./../head.ejs') %>
  <body>
    <%- include('./../header.ejs') %>

    <main class="d-flex flex-nowrap">
      <%- include('./../sidebar.ejs') %>

      <!-- Cuadros de proyectos -->

      <div class="container">
        <div class="container px-4 py-5" id="custom-cards">
          <h2 class="pb-2 border-bottom">Proyectos</h2>

          <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3" role="search">
            <input type="search" class="form-control" placeholder="Buscar Proyecto..." aria-label="Search">
        </form>
      
          <div class="row row-cols-1 row-cols-lg-3 align-items-stretch g-4 py-5" id="grid"></div>
        </div>
      </div>
    </main>

    <div class="container">
      <%- include('./../footer.ejs') %>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <%- include('./../script.ejs') %>

    <script>
      var elemento = document.getElementById('proyectos-link');
      elemento.className = 'nav-link active';
    </script>
    <%- include('./script_proyectos.ejs') %>
  </body>
  <script>
    let currentPage = 1; // Página actual, inicializada en 1
  
    // Función para cargar proyectos según la página
    async function cargarProyectos(page) {
      try {
        const res = await fetch(`/proyectos/proyectos?page=${page}`);
        if (!res.ok) {
          throw new Error('Error al cargar proyectos');
        }
        const data = await res.json();
        mostrarProyectos(data.proyectos);
      } catch (error) {
        console.error(error);
      }
    }
  
    // Función para mostrar proyectos en la interfaz
    function mostrarProyectos(proyectos) {
      const grid = document.getElementById('grid');
      grid.innerHTML = ''; // Limpiar el contenido anterior del grid
      proyectos.forEach((proyecto) => {
        // Renderizar proyecto en el grid
        const proyectoHTML = `
          <div class="col">
            <!-- Contenido del proyecto aquí -->
          </div>
        `;
        grid.innerHTML += proyectoHTML;
      });
    }
  
    // Manejar clic en botón de página anterior
    document.getElementById('paginaAnterior').addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        cargarProyectos(currentPage);
      }
    });
  
    // Manejar clic en botón de página siguiente
    document.getElementById('paginaSiguiente').addEventListener('click', () => {
      // Se debería verificar si hay más páginas disponibles
      currentPage++;
      cargarProyectos(currentPage);
    });
  
    // Cargar proyectos de la página actual al cargar la página
    document.addEventListener('DOMContentLoaded', () => {
      cargarProyectos(currentPage);
    });
  </script>
  
</html>